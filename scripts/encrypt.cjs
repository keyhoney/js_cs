// (?? ??? ?? ??) build_encrypted.cjs? ???????.
// ??? ?? encrypt.cjs? ?? ???? ?????.

const fs = require('fs');
const path = require('path');
const crypto = require('crypto-js');

const root = path.join(__dirname, '..');

// constants.ts? DATA_KEY? ??? ???? ???.
const DATA_KEY = 'HoneyCounseling2025!@#Secure';

const targets = [
  path.join(root, 'public', 'data', 'univ_rules.json'),
  path.join(root, 'public', 'data', 'score_table.json'),
  path.join(root, 'public', 'data', 'admission_data.json'),
  path.join(root, 'public', 'data', 'conversion_table.json'),
];

for (const file of targets) {
  if (!fs.existsSync(file)) throw new Error(`??? ????: ${file}`);
  const plain = fs.readFileSync(file, 'utf8');
  JSON.parse(plain); // ?? JSON? ??? ??? ??
  const cipher = crypto.AES.encrypt(plain, DATA_KEY).toString();
  fs.writeFileSync(file, cipher, 'utf8');
}

console.log('??? ??: public/data/*.json ??? ????? ???????.');
console.log('??: ?? ??? ?? JSON? ????, build_encrypted.cjs ??? ?????.');
